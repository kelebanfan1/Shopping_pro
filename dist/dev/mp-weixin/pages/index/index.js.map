{"version":3,"file":"index.js","sources":["../../../../../src/pages/index/index.vue","../../../../../uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<script setup lang=\"ts\">\r\n// import XtxSwiper from '@/components/XtxSwiper.vue'\r\nimport CustomNavbar from './components/CustomNavbar.vue'\r\nimport CategoryPanel from './components/CategoryPanel.vue'\r\nimport HotPanel from './components/HotPanel.vue'\r\nimport PageSkeleton from './components/PageSkeleton.vue'\r\nimport { getHomeBannerAPI, getHomeCategoryAPI, getHomeHotAPI } from '@/services/home'\r\nimport { onLoad } from '@dcloudio/uni-app'\r\nimport { ref } from 'vue'\r\nimport type { BannerItem, CategoryItem, HotItem } from '@/types/home'\r\nimport type { XtxGuessInstance } from '@/types/component'\r\nimport { useGuessList } from '@/composables'\r\n//获取轮播图数据\r\nconst bannerList = ref<BannerItem[]>([])\r\nconst getHomeBannerData = async () => {\r\n  const res = await getHomeBannerAPI()\r\n  // console.log(res)\r\n  bannerList.value = res.result\r\n}\r\n//获取前台分类数据\r\nconst categoryList = ref<CategoryItem[]>([])\r\nconst getHomeCategoryData = async () => {\r\n  const res = await getHomeCategoryAPI()\r\n  // console.log(res)\r\n  categoryList.value = res.result\r\n}\r\n//获取热门推荐数据\r\nconst hotList = ref<HotItem[]>([])\r\nconst getHomeHotData = async () => {\r\n  const res = await getHomeHotAPI()\r\n  hotList.value = res.result\r\n}\r\n//是否加载中标记\r\nconst isLoding = ref(false)\r\nonLoad(async () => {\r\n  isLoding.value = true\r\n  // getHomeBannerData()\r\n  // getHomeCategoryData()\r\n  // getHomeHotData()\r\n  await Promise.all([getHomeBannerData(), getHomeCategoryData(), getHomeHotData()])\r\n  isLoding.value = false\r\n})\r\n\r\n// //获取猜你喜欢组件实例\r\n// const guessRef = ref<XtxGuessInstance>()\r\n// //滚动触底\r\n// const onScrolltolower = () => {\r\n//   guessRef.value?.getMore()\r\n// }\r\n//使用猜你喜欢实例\r\nconst { guessRef, onSrolltolower } = useGuessList()\r\n//当前下拉刷新状态\r\nconst triggered = ref(false)\r\n//自定义下拉刷新被触发\r\nconst onRefresherrefresh = async () => {\r\n  //开始动画\r\n  triggered.value = true\r\n  // await getHomeBannerData()\r\n  // await getHomeCategoryData()\r\n  // await getHomeHotData()\r\n  //优化，同时请求\r\n  //重置猜你喜欢数据\r\n  guessRef.value?.resetData()\r\n  await Promise.all([\r\n    getHomeBannerData(),\r\n    getHomeCategoryData(),\r\n    getHomeHotData(),\r\n    guessRef.value?.getMore(),\r\n  ])\r\n  //结束动画\r\n  triggered.value = false\r\n}\r\n</script>\r\n\r\n<template>\r\n  <CustomNavbar></CustomNavbar>\r\n  <!-- 滚动容器 触底刷新 -->\r\n  <scroll-view\r\n    refresher-enabled\r\n    @refresherrefresh=\"onRefresherrefresh\"\r\n    :refresher-triggered=\"triggered\"\r\n    @scrolltolower=\"onSrolltolower\"\r\n    scroll-y\r\n    class=\"scroll-view\"\r\n  >\r\n    <PageSkeleton v-if=\"isLoding\"></PageSkeleton>\r\n    <template v-else>\r\n      <!-- 轮播图 -->\r\n      <XtxSwiper :list=\"bannerList\"></XtxSwiper>\r\n      <!-- 分类 -->\r\n      <CategoryPanel :list=\"categoryList\" />\r\n      <!-- 热门推荐 -->\r\n      <HotPanel :list=\"hotList\" />\r\n      <!-- 猜你喜欢 -->\r\n      <XtxGuess ref=\"guessRef\"></XtxGuess>\r\n    </template>\r\n  </scroll-view>\r\n</template>\r\n\r\n<style lang=\"scss\">\r\npage {\r\n  background-color: #f7f7f7;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n.scroll-view {\r\n  flex: 1;\r\n}\r\n</style>\r\n","import MiniProgramPage from 'E:/uniapp-pro/heima-shop/src/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","getHomeBannerAPI","getHomeCategoryAPI","getHomeHotAPI","onLoad","useGuessList"],"mappings":";;;;;;;;;;;;;;;;;AAEA,MAAA,eAAyB,MAAA;AACzB,MAAA,gBAA0B,MAAA;AAC1B,MAAA,WAAqB,MAAA;AACrB,MAAA,eAAyB,MAAA;;;;AAQnB,UAAA,aAAaA,kBAAkB,CAAA,CAAE;AACvC,UAAM,oBAAoB,YAAY;AAC9B,YAAA,MAAM,MAAMC,cAAAA;AAElB,iBAAW,QAAQ,IAAI;AAAA,IAAA;AAGnB,UAAA,eAAeD,kBAAoB,CAAA,CAAE;AAC3C,UAAM,sBAAsB,YAAY;AAChC,YAAA,MAAM,MAAME,cAAAA;AAElB,mBAAa,QAAQ,IAAI;AAAA,IAAA;AAGrB,UAAA,UAAUF,kBAAe,CAAA,CAAE;AACjC,UAAM,iBAAiB,YAAY;AAC3B,YAAA,MAAM,MAAMG,cAAAA;AAClB,cAAQ,QAAQ,IAAI;AAAA,IAAA;AAGhB,UAAA,WAAWH,kBAAI,KAAK;AAC1BI,kBAAAA,OAAO,YAAY;AACjB,eAAS,QAAQ;AAIX,YAAA,QAAQ,IAAI,CAAC,kBAAA,GAAqB,uBAAuB,eAAgB,CAAA,CAAC;AAChF,eAAS,QAAQ;AAAA,IAAA,CAClB;AASD,UAAM,EAAE,UAAU,eAAe,IAAIC,kBAAa,aAAA;AAE5C,UAAA,YAAYL,kBAAI,KAAK;AAE3B,UAAM,qBAAqB,YAAY;;AAErC,gBAAU,QAAQ;AAMlB,qBAAS,UAAT,mBAAgB;AAChB,YAAM,QAAQ,IAAI;AAAA,QAChB,kBAAkB;AAAA,QAClB,oBAAoB;AAAA,QACpB,eAAe;AAAA,SACf,cAAS,UAAT,mBAAgB;AAAA,MAAQ,CACzB;AAED,gBAAU,QAAQ;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrEpB,GAAG,WAAW,eAAe;"}